<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nederbeek â€“ Meldkamer (Admin)</title>

  <style>
    :root{
      --bg:#001b35;
      --card:#07243d;
      --muted:#a9c2d6;
      --accent:#ffc600;
      --danger:#c62828;
      --ok:#2e7d32;
      --white:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,Arial,Helvetica,sans-serif;
      background:linear-gradient(180deg,#001b35,#002415);
      color:var(--white);
      overflow-x:hidden;
    }
    .container{max-width:1200px;margin:20px auto;padding:16px}
    .card{background:var(--card);padding:14px;border-radius:14px;margin-bottom:14px;box-shadow:0 8px 18px rgba(0,0,0,.5)}
    h1,h2,h3{margin:0 0 8px}
    .muted{color:var(--muted);font-size:13px}
    input,select,button{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.08);background:#021a2d;color:white}
    button{cursor:pointer;font-weight:700}
    .btn{background:var(--accent);color:#001b35}
    .btn.danger{background:var(--danger);color:white}
    .btn.ghost{background:transparent}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,.06);text-align:left;font-size:14px}

    /* kerst */
    .snowflake{position:fixed;top:-10px;color:white;font-size:14px;opacity:.8;animation:fall linear infinite;pointer-events:none}
    @keyframes fall{to{transform:translateY(110vh)}}
  </style>
</head>
<body>

<div class="container">
  <h1>ðŸŽ„ Nederbeek Meldkamer</h1>
  <div class="muted">Admin & live overzicht</div>

  <!-- LOGIN -->
  <div id="loginCard" class="card">
    <h3>Inloggen</h3>
    <input id="naam" placeholder="Naam" />
    <input id="roep" placeholder="Roepnummer" style="margin-top:8px" />
    <button id="loginBtn" class="btn" style="margin-top:10px">Inloggen</button>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" style="display:none">
    <div class="grid">
      <div class="card">
        <h3>ðŸ‘¥ Ingelogde gebruikers</h3>
        <table>
          <thead><tr><th>Naam</th><th>Roep</th><th>Status</th><th>Tijd</th></tr></thead>
          <tbody id="userTable"></tbody>
        </table>
      </div>

      <div class="card">
        <h3>ðŸ›‘ Noodmelding</h3>
        <button id="noodBtn" class="btn danger">ACTIVEER NOOD</button>
        <button id="resetNood" class="btn ghost" style="margin-top:8px">Reset</button>
        <div id="noodStatus" class="muted" style="margin-top:6px"></div>
      </div>
    </div>

    <div class="card">
      <h3>ðŸ§¾ VTA overzicht</h3>
      <table>
        <thead><tr><th>Naam</th><th>Kenteken</th><th>Kenmerken</th></tr></thead>
        <tbody id="vtaTable"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "JOUW_API_KEY",
    authDomain: "politie-nederbeek-fd6ff.firebaseapp.com",
    databaseURL: "https://politie-nederbeek-fd6ff-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "politie-nederbeek-fd6ff"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const auth = firebase.auth();

  const loginCard = document.getElementById('loginCard');
  const dashboard = document.getElementById('dashboard');
  const userTable = document.getElementById('userTable');
  const vtaTable = document.getElementById('vtaTable');
  const noodStatus = document.getElementById('noodStatus');

  document.getElementById('loginBtn').onclick = async () => {
    const naam = document.getElementById('naam').value.trim();
    const roep = document.getElementById('roep').value.trim();
    if(!naam || !roep) return alert('Alles invullen');

    await auth.signInAnonymously();
    const uid = auth.currentUser.uid;

    await db.ref('gebruikers/'+roep).set({
      naam, roep, status: 'online', timestamp: Date.now()
    });

    loginCard.style.display='none';
    dashboard.style.display='block';
  };

  // live gebruikers
  db.ref('gebruikers').on('value', snap => {
    userTable.innerHTML='';
    Object.values(snap.val()||{}).forEach(u=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${u.naam}</td><td>${u.roep}</td><td>${u.status}</td><td>${new Date(u.timestamp).toLocaleString()}</td>`;
      userTable.appendChild(tr);
    });
  });

  // noodmelding
  document.getElementById('noodBtn').onclick=()=>{
    db.ref('noodmelding').set({actief:true,tijd:Date.now()});
  };
  document.getElementById('resetNood').onclick=()=>{
    db.ref('noodmelding').set({actief:false});
  };

  db.ref('noodmelding').on('value',snap=>{
    const d=snap.val();
    noodStatus.textContent = d?.actief ? 'ðŸš¨ ACTIEF' : 'Geen noodmelding';
  });

  // VTA lijst
  db.ref('vtas').on('value', snap=>{
    vtaTable.innerHTML='';
    Object.values(snap.val()||{}).forEach(v=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${v.naam||''}</td><td>${v.kenteken||''}</td><td>${v.kenmerken||''}</td>`;
      vtaTable.appendChild(tr);
    });
  });

  // sneeuw
  setInterval(()=>{
    const s=document.createElement('div');
    s.className='snowflake';
    s.textContent='â„';
    s.style.left=Math.random()*100+'vw';
    s.style.animationDuration=(3+Math.random()*5)+'s';
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),8000);
  },300);
</script>
</body>
</html>
